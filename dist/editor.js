/*! For license information please see editor.js.LICENSE.txt */
!function(){var e={184:function(e,t){var r;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var l=typeof r;if("string"===l||"number"===l)e.push(r);else if(Array.isArray(r)){if(r.length){var a=o.apply(null,r);a&&e.push(a)}}else if("object"===l)if(r.toString===Object.prototype.toString)for(var i in r)n.call(r,i)&&r[i]&&e.push(i);else e.push(r.toString())}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,r),l.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=wp.blocks,t=wp.domReady,n=r.n(t),o=wp.hooks,l=wp.plugins,a=lodash,i=wp.i18n,s=wp.compose,c=wp.data,u=function(e){return"center"===e.attributes.verticalAlignment},m=function(e){var t=[],r=(0,(0,c.select)("core/block-editor").getBlock)(e.block.clientId);switch(e.name){case"core/group":e.attributes.__nestedGroupWarning&&t.push((0,i.__)("Nested group","rrze-newsletter"));break;case"core/columns":if(r){var n=r.innerBlocks,o=(0,a.some)(n,u),l=(0,a.every)(n,u);o&&!l&&t.push((0,i.__)("Unequal middle alignment. All or none of the columns should be middle-aligned.","rrze-newsletter"))}break;case"core/column":e.attributes.__nestedColumnWarning&&t.push((0,i.__)("Nested columns","rrze-newsletter"));break;case"core/image":t=function(e,t){return"left"!==t.attributes.align&&"right"!==t.attributes.align||e.push((0,i.__)("Side alignment","rrze-newsletter")),e}(t,e),"full"===e.attributes.align&&t.push((0,i.__)("Full width","rrze-newsletter"));break;case"core/paragraph":e.attributes.content.indexOf("<img")>=0&&t.push((0,i.__)("Inline image","rrze-newsletter")),e.attributes.dropCap&&t.push((0,i.__)("Drop cap","rrze-newsletter"))}return t},p=(0,s.createHigherOrderComponent)((function(e){return function(t){var r=m(t);return r.length?wp.element.createElement("div",{className:"rrze-newsletter__editor-block"},wp.element.createElement("div",{className:"rrze-newsletter__editor-block__warning components-notice is-error"},(0,i.__)("These features will not be displayed correctly in an email, please remove them:","rrze-newsletter"),r.map((function(e,t){return wp.element.createElement("strong",{key:t},wp.element.createElement("br",null),e)}))),wp.element.createElement(e,t)):wp.element.createElement(e,t)}}),"withInspectorControl"),f=wp.element;function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=(0,s.compose)([(0,c.withSelect)((function(e){return{blocks:(0,e("core/block-editor").getBlocks)()}})),(0,c.withDispatch)((function(e){return{updateBlock:function(t,r){e("core/block-editor").replaceBlock(t,r)}}}))])((function(e){var t=e.blocks,r=e.updateBlock,n=function(e,t,n){var o=!0===e.attributes[n];t&&!o?r(e.clientId,w(w({},e),{},{attributes:w(w({},e.attributes),{},y({},n,!0))})):!t&&o&&r(e.clientId,w(w({},e),{},{attributes:w(w({},e.attributes),{},y({},n,!1))}))},o=function e(t){if("core/column"===t.name){var r=(0,a.some)(t.innerBlocks,(function(e){return"core/columns"===e.name}));n(t,r,"__nestedColumnWarning")}t.innerBlocks.forEach(e)},l=function e(t){n(t,"core/group"===t.name,"__nestedGroupWarning"),t.innerBlocks.forEach(e)};return(0,f.useEffect)((function(){t.forEach((function(e){e.innerBlocks.forEach(o),e.innerBlocks.forEach(l)}))}),[t]),null})),_=wp.editPost,v=wp.components,h=r(184),g=r.n(h),E="newsletter_layout",P=function(e){return e&&e.post_type===E},S=wp.apiFetch,O=r.n(S);function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,l=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw l}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var j=function(){var e=z((0,f.useState)(!0),2),t=e[0],r=e[1],n=z((0,f.useState)([]),2),o=n[0],l=n[1];(0,f.useEffect)((function(){O()({path:"/rrze-newsletter/v1/layouts"}).then((function(e){l(e),r(!1)}))}),[]);return{layouts:o,isFetchingLayouts:t,deleteLayoutPost:function(e){l(o.filter((function(t){return t.ID!==e}))),O()({path:"/wp/v2/".concat(E,"/").concat(e),method:"DELETE"})}}},C=wp.keycodes,A=wp.blockEditor;function I(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var N=function(e){var t=e.meta,r=void 0===t?{}:t,n=I(e,["meta"]),o=(0,f.useMemo)((function(){return"preview-".concat(Math.round(1e3*Math.random()))}),[]);return wp.element.createElement(f.Fragment,null,wp.element.createElement("style",null,"".concat(r.rrze_newsletter_font_body?"\n#".concat(o," *:not( code ) {\n  font-family: ").concat(r.rrze_newsletter_font_body,";\n}"):" ").concat(r.rrze_newsletter_font_header?"\n#".concat(o," h1, #").concat(o," h2, #").concat(o," h3, #").concat(o," h4, #").concat(o," h5, #").concat(o," h6 {\n  font-family: ").concat(r.rrze_newsletter_font_header,";\n}"):" ")),wp.element.createElement("div",{id:o,className:"rrze-newsletter__layout-preview",style:{backgroundColor:r.rrze_newsletter_background_color}},wp.element.createElement(A.BlockPreview,n)))};function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,l=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw l}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var F=(0,c.withDispatch)((function(e,t){var r=t.ID,n=e("core").saveEntityRecord;return{saveLayout:function(e){return n("postType",E,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({status:"publish",id:r},e))}}}))((function(t){var r=t.isEditable,n=t.deleteHandler,o=t.saveLayout,l=t.selectedLayoutId,a=t.setSelectedLayoutId,s=t.ID,c=t.post_title,u=t.post_content,m=t.meta,p=x((0,f.useState)(c),2),d=p[0],w=p[1],y=x((0,f.useState)(!1),2),b=y[0],_=y[1],h=function(){d!==c&&(_(!0),o({title:d}).then((function(){_(!1)})))},E=(0,f.useMemo)((function(){return(0,e.parse)(u).map((function(e){return e}))}),[u]);return wp.element.createElement("div",{key:s,className:g()("rrze-newsletter-layouts__item",{"is-active":l===s})},wp.element.createElement("div",{className:"rrze-newsletter-layouts__item-preview",onClick:function(){return a(s)},onKeyDown:function(e){C.ENTER!==e.keyCode&&C.SPACE!==e.keyCode||(e.preventDefault(),a(s))},role:"button",tabIndex:"0","aria-label":c},""===u?null:wp.element.createElement(N,{meta:m,blocks:E,viewportWidth:600})),r?wp.element.createElement(v.TextControl,{className:"rrze-newsletter-layouts__item-label",value:d,onChange:w,onBlur:h,disabled:b,onKeyDown:function(e){C.ENTER===e.keyCode&&h()}}):wp.element.createElement("div",{className:"rrze-newsletter-layouts__item-label"},c),r&&wp.element.createElement(v.Button,{isDestructive:!0,isLink:!0,onClick:function(){confirm((0,i.__)("Are you sure you want to delete this layout?","rrze-newsletter"))&&n(s)},disabled:b},(0,i.__)("Delete","rrze-newsletter")))}));function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,l=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw l}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var W=[{title:(0,i.__)("Prebuilt","rrze-newsletter"),filter:function(e){return void 0===e.post_author}},{title:(0,i.__)("Saved","rrze-newsletter"),filter:P,isEditable:!0}],$=(0,s.compose)([(0,c.withSelect)((function(e){return{getBlocks:e("core/block-editor").getBlocks}})),(0,c.withDispatch)((function(e){var t=e("core/editor"),r=t.savePost,n=t.editPost,o=e("core/block-editor");return{savePost:r,insertBlocks:o.insertBlocks,replaceBlocks:o.replaceBlocks,setNewsletterMeta:function(e){return n({meta:e})}}}))])((function(t){var r=t.getBlocks,n=t.insertBlocks,o=t.replaceBlocks,l=t.savePost,s=t.setNewsletterMeta,c=j(),u=c.layouts,m=c.isFetchingLayouts,p=c.deleteLayoutPost,d=function(t){var i=(0,a.find)(u,{ID:t})||{},c=i.post_content,m=i.meta,p=void 0===m?{}:m,f=c?(0,e.parse)(c):[],d=r().map((function(e){return e.clientId}));d.length?o(d,f):n(f);var w=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){H(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({rrze_newsletter_template_id:t},p);s(w),setTimeout(l,1)},w=L((0,f.useState)(null),2),y=w[0],b=w[1],_=(0,f.useMemo)((function(){var t=y&&(0,a.find)(u,{ID:y});return t?{blocks:(0,e.parse)(t.post_content),meta:t.meta}:null}),[y,u.length]),h=_&&_.blocks.length>0,E=L((0,f.useState)(0),2),S=E[0],O=E[1],z=W[S],k=u.filter(z.filter);return(0,f.useEffect)((function(){u.filter(P).length&&O(1)}),[u.length]),wp.element.createElement(f.Fragment,null,wp.element.createElement("div",{className:"rrze-newsletter-modal__content"},wp.element.createElement("div",{className:"rrze-newsletter-tabs rrze-newsletter-buttons-group"},W.map((function(e,t){var r=e.title;return wp.element.createElement(v.Button,{key:t,disabled:m,className:g()("rrze-newsletter-tabs__button",{"rrze-newsletter-tabs__button--is-active":!m&&t===S}),onClick:function(){return O(t)}},r)}))),wp.element.createElement("div",{className:g()("rrze-newsletter-modal__layouts",{"rrze-newsletter-modal__layouts--loading":m})},m?wp.element.createElement(v.Spinner,null):wp.element.createElement("div",{className:g()({"rrze-newsletter-layouts":k.length>0})},k.length?k.map((function(e){return wp.element.createElement(F,M({key:e.ID,selectedLayoutId:y,setSelectedLayoutId:b,deleteHandler:p,isEditable:z.isEditable},e))})):wp.element.createElement("span",null,(0,i.__)('Turn any newsletter to a layout via the "Layout" sidebar menu in the editor.',"rrze-newsletter")))),wp.element.createElement("div",{className:"rrze-newsletter-modal__preview"},!m&&(h?wp.element.createElement(N,M({},_,{viewportWidth:600})):wp.element.createElement("p",null,(0,i.__)("Select a layout to preview.","rrze-newsletter"))))),wp.element.createElement("div",{className:"rrze-newsletter-modal__action-buttons"},wp.element.createElement(v.Button,{isSecondary:!0,onClick:function(){return d(0)}},(0,i.__)("Start With A Blank Layout","rrze-newsletter")),wp.element.createElement("span",{className:"separator"}," "),wp.element.createElement(v.Button,{isPrimary:!0,disabled:m||!h,onClick:function(){return d(y)}},(0,i.__)("Use Selected Layout","rrze-newsletter"))))})),V=function(){return wp.element.createElement(v.Modal,{className:"rrze-newsletter-modal__frame",isDismissible:!1,overlayClassName:"rrze-newsletter-modal__screen-overlay",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1,title:(0,i.__)("Select a layout for the newsletter","rrze-newsletter")},wp.element.createElement($,null))};function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,l=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw l}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){Q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var X=(0,s.compose)([(0,c.withSelect)((function(e){var t=e("core/editor"),r=t.getEditedPostAttribute,n=t.isEditedPostEmpty,o=t.getCurrentPostId,l=e("core/block-editor").getBlocks,a=r("meta"),i=a.rrze_newsletter_template_id,s=a.rrze_newsletter_background_color,c=a.rrze_newsletter_font_body,u=a.rrze_newsletter_font_header;return{layoutId:i,postTitle:r("title"),postBlocks:l(),isEditedPostEmpty:n(),currentPostId:o(),stylingMeta:{rrze_newsletter_background_color:s,rrze_newsletter_font_body:c,rrze_newsletter_font_header:u}}})),(0,c.withDispatch)((function(e,t){var r=t.currentPostId,n=t.stylingMeta,o=e("core/block-editor").replaceBlocks,l=e("core/editor").editPost,a=e("core").saveEntityRecord;return{replaceBlocks:o,saveLayoutIdMeta:function(e){l({meta:{rrze_newsletter_template_id:e}}),a("postType","newsletter",{id:r,meta:J({rrze_newsletter_template_id:e},n)})},saveLayout:function(e){return a("postType",E,J({status:"publish"},e))}}}))])((function(t){var r=t.saveLayoutIdMeta,n=t.layoutId,o=t.replaceBlocks,l=t.saveLayout,s=t.postBlocks,c=t.postTitle,u=t.isEditedPostEmpty,m=t.stylingMeta,p=q((0,f.useState)(!1),2),d=p[0],w=p[1],y=j(),b=y.layouts,_=y.isFetchingLayouts,h=q((0,f.useState)({}),2),g=h[0],S=h[1];(0,f.useEffect)((function(){S((0,a.find)(b,{ID:n})||{})}),[b.length]);var O=(0,f.useMemo)((function(){return g.post_content?(0,e.parse)(g.post_content):null}),[g]),z=q((0,f.useState)(!1),2),k=z[0],C=z[1],A=q((0,f.useState)(null),2),I=A[0],B=A[1],D=q((0,f.useState)(c),2),x=D[0],T=D[1],F=function(e){C(!1),r(e.id),S(J(J({},e),{},{post_content:e.content.raw,post_title:e.title.raw,post_type:E}))},M=(0,f.useMemo)((function(){return(0,e.serialize)(s)}),[s]),L=M===g.post_content&&(0,a.isEqual)(g.meta,m),R=P(g);return wp.element.createElement(f.Fragment,null,Boolean(n&&_)&&wp.element.createElement("div",{className:"rrze-newsletter-layouts__spinner"},wp.element.createElement(v.Spinner,null)),null!==O&&wp.element.createElement("div",{className:"rrze-newsletter-layouts"},wp.element.createElement("div",{className:"rrze-newsletter-layouts__item"},wp.element.createElement("div",{className:"rrze-newsletter-layouts__item-preview"},wp.element.createElement(N,{meta:g.meta,blocks:O,viewportWidth:600})),wp.element.createElement("div",{className:"rrze-newsletter-layouts__item-label"},g.post_title))),wp.element.createElement("div",{className:"rrze-newsletter-buttons-group rrze-newsletter-buttons-group--spaced"},wp.element.createElement(v.Button,{isPrimary:!0,disabled:u||k,onClick:function(){return B(!0)}},(0,i.__)("Save new layout","rrze-newsletter")),R&&wp.element.createElement(v.Button,{isSecondary:!0,disabled:L||k,onClick:function(){if(confirm((0,i.__)("Are you sure you want to overwrite this layout?","rrze-newsletter"))){C(!0);var e={id:g.ID,content:M,meta:m};l(e).then(F)}}},(0,i.__)("Update layout","rrze-newsletter"))),wp.element.createElement("br",null),wp.element.createElement(v.Button,{isSecondary:!0,isLink:!0,isDestructive:!0,onClick:function(){return w(!0)}},(0,i.__)("Reset newsletter layout","rrze-newsletter")),I&&wp.element.createElement(v.Modal,{className:"rrze-newsletter__modal",title:(0,i.__)("Save newsletter as a layout","rrze-newsletter"),onRequestClose:function(){return B(null)}},wp.element.createElement(v.TextControl,{label:(0,i.__)("Title","rrze-newsletter"),disabled:k,value:x,onChange:T}),wp.element.createElement(v.Button,{isPrimary:!0,disabled:k||0===x.length,onClick:function(){C(!0),l({title:x,content:M,meta:m}).then((function(e){B(!1),F(e)}))}},(0,i.__)("Save","rrze-newsletter")),wp.element.createElement(v.Button,{isSecondary:!0,onClick:function(){return B(null)}},(0,i.__)("Cancel","rrze-newsletter"))),d&&wp.element.createElement(v.Modal,{className:"rrze-newsletter__modal",title:(0,i.__)("Overwrite newsletter content?","rrze-newsletter"),onRequestClose:function(){return w(!1)}},wp.element.createElement("p",null,(0,i.__)("Changing the newsletter's layout will remove any customizations or edits you have already made.","rrze-newsletter")),wp.element.createElement(v.Button,{isPrimary:!0,onClick:function(){var e;(e=s.map((function(e){return e.clientId})))&&e.length&&o(e,[]),r(-1),w(!1)}},(0,i.__)("Reset layout","rrze-newsletter")),wp.element.createElement(v.Button,{isSecondary:!0,onClick:function(){return w(!1)}},(0,i.__)("Cancel","rrze-newsletter"))))})),Y=function(e){return/\S+@\S+/.test(e)},Z={generic:{validateNewsletter:function(e){var t=e.status,r=[];return"sent"!==t&&"sending"!==t||r.push((0,i.__)("Newsletter has already been sent.","rrze-newsletter")),r},getFetchDataConfig:function(e){var t=e.postId;return{path:"/rrze-newsletter/v1/email/".concat(t)}},ProviderSidebar:function(e){var t=e.postId,r=e.apiFetch,n=e.renderSubject,o=e.renderFrom;return wp.element.createElement(f.Fragment,null,n(),o({handleSenderUpdate:function(e){var n=e.senderName,o=e.senderEmail;return r({path:"/rrze-newsletter/v1/email/".concat(t,"/sender"),data:{rrze_newsletter_from_name:n,rrze_newsletter_replyto:o},method:"POST"})}}))},renderPreSendInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return wp.element.createElement("p",null,(0,i.__)("Sending newsletter to:","rrze-newsletter")," ",e.listName)}}};function ee(){return(ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,l=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw l}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ne=function(){return(0,s.createHigherOrderComponent)((function(e){return function(t){var r=te((0,f.useState)(!1),2),n=r[0],o=r[1],l=te((0,f.useState)({}),2),a=l[0],s=l[1],u=(0,c.dispatch)("core/notices"),m=u.createSuccessNotice,p=u.createErrorNotice,d=u.removeNotice,w=(0,c.select)("core/notices").getNotices,y=(0,i.__)("Newsletter sent on ","rrze-newsletter");return wp.element.createElement(e,ee({},t,{apiFetchWithErrorHandling:function(e){return o(!0),new Promise((function(t,r){O()(e).then((function(e){var r=e.message;w().forEach((function(e){"error"===e.status||"success"===e.status&&-1!==e.content.indexOf(y)||d(e.id)})),r&&m(r),o(!1),s({}),t(e)})).catch((function(e){var t,n,l,a=e.message;w().forEach((function(e){"error"===e.status||"success"===e.status&&-1!==e.content.indexOf(y)||d(e.id)})),p(a),o(!1),s((t={},n=e.code,l=!0,n in t?Object.defineProperty(t,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[n]=l,t)),r(e)}))}))},errors:a,setInFlightForAsync:function(){o(!0)},inFlight:n,successNote:y}))}}),"with-api-handler")},oe=(0,s.compose)([ne(),(0,c.withSelect)((function(e){var t=e("core/editor"),r=t.getEditedPostAttribute,n=t.getCurrentPostId,o=r("meta");return{title:r("title"),postId:n(),senderName:o.rrze_newsletter_from_name||"",senderEmail:o.rrze_newsletter_from_email||"",replytoEmail:o.rrze_newsletter_replyto||"",previewText:o.rrze_newsletter_preview_text||"",newsletterData:o.newsletterData||{}}})),(0,c.withDispatch)((function(e){return{editPost:e("core/editor").editPost}}))])((function(e){var t=e.inFlight,r=e.errors,n=e.editPost,o=e.title,l=e.senderName,a=e.senderEmail,s=e.replytoEmail,c=e.previewText,u=e.newsletterData,m=e.apiFetchWithErrorHandling,p=e.postId,d=g()("rrze-newsletter__email-textcontrol",r.rrze_newsletter_unverified_sender_domain&&"rrze-newsletter__error"),w=function(e){return m({data:e,method:"POST",path:"/rrze-newsletter/v1/post-meta/".concat(p)})},y=Z.generic.ProviderSidebar;return wp.element.createElement(f.Fragment,null,wp.element.createElement(y,{postId:p,newsletterData:u,inFlight:t,renderSubject:function(){return wp.element.createElement(v.TextControl,{label:(0,i.__)("Subject","rrze-newsletter"),className:"rrze-newsletter__subject-textcontrol",value:o,disabled:t,onChange:function(e){return n({title:e})}})},renderFrom:function(){return wp.element.createElement(f.Fragment,null,wp.element.createElement("strong",null,(0,i.__)("From","rrze-newsletter")),wp.element.createElement(v.TextControl,{label:(0,i.__)("Name","rrze-newsletter"),className:"rrze-newsletter__name-textcontrol",value:l,disabled:t,onChange:function(e){return n({meta:{rrze_newsletter_from_name:e}})}}),wp.element.createElement(v.TextControl,{label:(0,i.__)("Email","rrze-newsletter"),className:d,value:a,type:"email",disabled:t,onChange:function(e){return n({meta:{rrze_newsletter_from_email:e}})}}),wp.element.createElement(v.TextControl,{label:(0,i.__)("ReplyTo","rrze-newsletter"),className:d,value:s,type:"email",disabled:t,onChange:function(e){return n({meta:{rrze_newsletter_replyto:e}})}}),wp.element.createElement(v.Button,{isLink:!0,onClick:function(){w({key:"rrze_newsletter_from_name",value:l}),w({key:"rrze_newsletter_from_email",value:a}),w({key:"rrze_newsletter_replyto",value:s})},disabled:t||!!a.length&&!Y(a)||!!s.length&&!Y(s)},(0,i.__)("Update Sender","rrze-newsletter")),wp.element.createElement(v.TextareaControl,{label:(0,i.__)("Preview text","rrze-newsletter"),className:"rrze-newsletter__name-textcontrol rrze-newsletter__name-textcontrol--separated",value:c,disabled:t,onChange:function(e){return n({meta:{rrze_newsletter_preview_text:e}})}}),wp.element.createElement(v.Button,{isLink:!0,onClick:function(){return w({key:"rrze_newsletter_preview_text",value:c})},disabled:t},(0,i.__)("Update preview text","rrze-newsletter")))},updateMeta:function(e){return n({meta:e})}}))}));function le(e,t,r,n,o,l,a){try{var i=e[l](a),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,o)}function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,l=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw l}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ie(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var se=(0,s.compose)([ne(),(0,c.withSelect)((function(e){return{postId:(0,e("core/editor").getCurrentPostId)()}})),(0,c.withDispatch)((function(e){return{savePost:e("core/editor").savePost}}))])((function(e){var t=e.apiFetchWithErrorHandling,r=e.inFlight,n=e.postId,o=e.savePost,l=e.setInFlightForAsync,a=ae((0,f.useState)(""),2),s=a[0],c=a[1],u=function(){var e,r=(e=regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(),e.next=3,o();case 3:r={path:"/rrze-newsletter/v1/email/".concat(n,"/test"),data:{test_email:s},method:"POST"},t(r);case 5:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var l=e.apply(t,r);function a(e){le(l,n,o,a,i,"next",e)}function i(e){le(l,n,o,a,i,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();return wp.element.createElement(f.Fragment,null,wp.element.createElement(v.TextControl,{label:(0,i.__)("Send a test to","rrze-newsletter"),value:s,type:"email",onChange:c,help:(0,i.__)("Use commas to separate multiple emails.","rrze-newsletter")}),wp.element.createElement("div",{className:"rrze-newsletter__testing-controls"},wp.element.createElement(v.Button,{isPrimary:!0,onClick:u,disabled:r||!Y(s)},r?(0,i.__)("Sending Test Email...","rrze-newsletter"):(0,i.__)("Send a Test Email","rrze-newsletter")),r&&wp.element.createElement(v.Spinner,null)))}));function ce(){return(ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ue(e){return function(e){if(Array.isArray(e))return me(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return me(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return me(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pe(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function fe(e){var t=e.help,r=e.label,n=e.multiple,o=void 0!==n&&n,l=e.onChange,i=e.optgroups,c=void 0===i?[]:i,u=e.className,m=e.hideLabelFromVision,p=pe(e,["help","label","multiple","onChange","optgroups","className","hideLabelFromVision"]),f=(0,s.useInstanceId)(fe),d="inspector-select-control-".concat(f);return(0,a.isEmpty)(c)?null:wp.element.createElement(v.BaseControl,{label:r,hideLabelFromVision:m,id:d,help:t,className:u},wp.element.createElement("select",ce({id:d,className:"components-select-control__input",onChange:function(e){if(o){var t=ue(e.target.options).filter((function(e){return e.selected})).map((function(e){return e.value}));l(t)}else l(e.target.value)},"aria-describedby":t?void 0:"".concat(d,"__help"),multiple:o},p),c.map((function(e,t){var r=e.label,n=e.options;return wp.element.createElement("optgroup",{label:r,key:t},n.map((function(e,t){return wp.element.createElement("option",{key:"".concat(e.label,"-").concat(e.value,"-").concat(t),value:e.value,disabled:e.disabled},e.label)})))}))))}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function we(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ye=[{label:(0,i.__)("Sans Serif","rrze-newsletter"),options:[{value:"Arial, Helvetica, sans-serif",label:(0,i.__)("Arial","rrze-newsletter")},{value:"Tahoma, sans-serif",label:(0,i.__)("Tahoma","rrze-newsletter")},{value:"Trebuchet MS, sans-serif",label:(0,i.__)("Trebuchet","rrze-newsletter")},{value:"Verdana, sans-serif",label:(0,i.__)("Verdana","rrze-newsletter")}]},{label:(0,i.__)("Serif","rrze-newsletter"),options:[{value:"Georgia, serif",label:(0,i.__)("Georgia","rrze-newsletter")},{value:"Palatino, serif",label:(0,i.__)("Palatino","rrze-newsletter")},{value:"Times New Roman, serif",label:(0,i.__)("Times New Roman","rrze-newsletter")}]},{label:(0,i.__)("Monospace","rrze-newsletter"),options:[{value:"Courier, monospace",label:(0,i.__)("Courier","rrze-newsletter")}]}],be=function(e){var t=(0,e("core/editor").getEditedPostAttribute)("meta");return{fontBody:t.rrze_newsletter_font_body||ye[1].options[0].value,fontHeader:t.rrze_newsletter_font_header||ye[0].options[0].value,backgroundColor:t.rrze_newsletter_background_color||"#ffffff"}},_e=(0,c.withSelect)(be)((function(e){var t=e.fontBody,r=e.fontHeader,n=e.backgroundColor;return(0,f.useEffect)((function(){document.documentElement.style.setProperty("--body-font",t)}),[t]),(0,f.useEffect)((function(){document.documentElement.style.setProperty("--header-font",r)}),[r]),(0,f.useEffect)((function(){var e=document.querySelector(".edit-post-visual-editor");e&&(e.style.backgroundColor=n)}),[n]),null})),ve=(0,s.compose)([(0,c.withDispatch)((function(e){return{editPost:e("core/editor").editPost}})),(0,c.withSelect)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?de(Object(r),!0).forEach((function(t){we(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({postId:(0,e("core/editor").getCurrentPostId)()},be(e))}))])((function(e){var t=e.editPost,r=e.fontBody,n=e.fontHeader,o=e.backgroundColor,l=e.postId,a=function(e,r){t({meta:we({},e,r)}),O()({data:{key:e,value:r},method:"POST",path:"/rrze-newsletter/v1/post-meta/".concat(l)})},c=(0,s.useInstanceId)(fe),u="inspector-select-control-".concat(c);return wp.element.createElement(f.Fragment,null,wp.element.createElement(fe,{label:(0,i.__)("Headings font","rrze-newsletter"),value:n,optgroups:ye,onChange:function(e){return a("rrze_newsletter_font_header",e)}}),wp.element.createElement(fe,{label:(0,i.__)("Body font","rrze-newsletter"),value:r,optgroups:ye,onChange:function(e){return a("rrze_newsletter_font_body",e)}}),wp.element.createElement(v.BaseControl,{label:(0,i.__)("Background color","rrze-newsletter"),id:u},wp.element.createElement(v.ColorPicker,{id:u,color:o,onChangeComplete:function(e){return a("rrze_newsletter_background_color",e.hex)},disableAlpha:!0})))})),he=(0,s.compose)([(0,c.withSelect)((function(e){return{meta:(0,e("core/editor").getEditedPostAttribute)("meta")}})),(0,c.withDispatch)((function(e){var t=e("core/editor").editPost;return{updateIsPublic:function(e){return t({meta:{rrze_newsletter_is_public:e}})}}}))])((function(e){var t=e.meta,r=e.updateIsPublic,n=t.rrze_newsletter_is_public;return wp.element.createElement(f.Fragment,null,wp.element.createElement(v.ToggleControl,{className:"rrze-newsletter__public-toggle-control",label:(0,i.__)("Make newsletter page public?","rrze-newsletter"),help:(0,i.__)("Make this newsletter viewable as a public page once it’s been sent.","rrze-newsletter"),checked:n,onChange:function(e){return r(e)}}))}));function ge(e,t,r,n,o,l,a){try{var i=e[l](a),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,o)}function Ee(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var l=e.apply(t,r);function a(e){ge(l,n,o,a,i,"next",e)}function i(e){ge(l,n,o,a,i,"throw",e)}a(void 0)}))}}function Pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,l=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw l}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Se(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Oe=(0,s.compose)([(0,c.withDispatch)((function(e){var t=e("core/editor");return{editPost:t.editPost,savePost:t.savePost}})),(0,c.withSelect)((function(e,t){var r=t.forceIsDirty,n=e("core/editor"),o=n.getCurrentPost,l=n.getEditedPostAttribute,i=n.getEditedPostVisibility,s=n.isEditedPostPublishable,c=n.isEditedPostSaveable,u=n.isSavingPost,m=n.isEditedPostBeingScheduled,p=n.isCurrentPostPublished;return{isPublishable:r||s(),isSaveable:c(),status:l("status"),isSaving:u(),isEditedPostBeingScheduled:m(),hasPublishAction:(0,a.get)(o(),["_links","wp:action-publish"],!1),visibility:i(),meta:l("meta"),isPublished:p()}}))])((function(e){var t,r,n=e.editPost,o=e.savePost,l=e.isPublishable,a=e.isSaveable,s=e.isSaving,c=e.status,u=e.isEditedPostBeingScheduled,m=e.hasPublishAction,p=e.visibility,d=e.meta,w=e.isPublished,y=d.newsletterValidationErrors,b=void 0===y?[]:y,_=d.rrze_newsletter_is_public,h=(l||u)&&a&&!w&&!s&&0===b.length;t=w?s?(0,i.__)("Sending","rrze-newsletter"):_?(0,i.__)("Sent and Published","rrze-newsletter"):(0,i.__)("Sent","rrze-newsletter"):"future"===c?(0,i.__)("Scheduled","rrze-newsletter"):u?(0,i.__)("Schedule sending","rrze-newsletter"):_?(0,i.__)("Send and Publish","rrze-newsletter"):(0,i.__)("Send","rrze-newsletter"),r=m?"private"===p?"private":u?"future":"publish":"pending";var g=Pe((0,f.useState)(!1),2),E=g[0],P=g[1];return w?wp.element.createElement(v.Button,{className:"editor-post-publish-button",isBusy:s,isPrimary:!0,disabled:s,onClick:o},s?(0,i.__)("Updating...","rrze-newsletter"):(0,i.__)("Update","rrze-newsletter")):wp.element.createElement(f.Fragment,null,wp.element.createElement(v.Button,{className:"editor-post-publish-button",isBusy:s&&"publish"===c,isPrimary:!0,onClick:Ee(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:P(!0);case 3:case"end":return e.stop()}}),e)}))),disabled:!h},t),E&&wp.element.createElement(v.Modal,{className:"rrze-newsletter__modal",title:(0,i.__)("Send your newsletter?","rrze-newsletter"),onRequestClose:function(){return P(!1)}},b.length?wp.element.createElement(v.Notice,{status:"error",isDismissible:!1},(0,i.__)("The following errors prevent the newsletter from being sent:","rrze-newsletter"),wp.element.createElement("ul",null,b.map((function(e,t){return wp.element.createElement("li",{key:t},e)})))):null,wp.element.createElement(v.Button,{isPrimary:!0,disabled:b.length>0,onClick:function(){n({status:r}),o(),P(!1)}},(0,i.__)("Send","rrze-newsletter")),wp.element.createElement(v.Button,{isSecondary:!0,onClick:function(){return P(!1)}},(0,i.__)("Cancel","rrze-newsletter"))))}));function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,l=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw l}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ke(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ke(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var je=(0,s.compose)([ne(),(0,c.withSelect)((function(e){var t=e("core/editor"),r=t.getCurrentPostId,n=t.getCurrentPostAttribute,o=t.getEditedPostAttribute,l=t.isPublishingPost,a=t.isSavingPost,i=t.isCleanNewPost,s=e("core/edit-post").getActiveGeneralSidebarName,c=o("meta"),u=n("status"),m=n("date");return{isCleanNewPost:i(),postId:r(),isReady:!!c.newsletterValidationErrors&&0===c.newsletterValidationErrors.length,activeSidebarName:s(),isPublishingOrSavingPost:a()||l(),status:u,sentDate:m,isPublic:c.rrze_newsletter_is_public}})),(0,c.withDispatch)((function(e){var t=e("core/editor");return{lockPostAutosaving:t.lockPostAutosaving,lockPostSaving:t.lockPostSaving,unlockPostSaving:t.unlockPostSaving,editPost:t.editPost,createNotice:e("core/notices").createNotice}}))])((function(e){var t=ze((0,f.useState)(document.createElement("div")),1)[0];return(0,f.useEffect)((function(){var e=document.getElementsByClassName("editor-post-publish-button__button")[0];e.parentNode.insertBefore(t,e)}),[]),(0,f.useEffect)((function(){(0,a.isEmpty)(e.colorPalette)||e.apiFetchWithErrorHandling({path:"/rrze-newsletter/v1/color-palette",data:e.colorPalette,method:"POST"})}),[JSON.stringify(e.colorPalette)]),(0,f.useEffect)((function(){e.isReady?e.unlockPostSaving("rrze-newsletter-post-lock"):e.lockPostSaving("rrze-newsletter-post-lock")}),[e.isReady]),(0,f.useEffect)((function(){if("publish"===e.status&&!e.isPublishingOrSavingPost){var t=e.sentDate?new Date(e.sentDate).toLocaleString():"";e.lockPostAutosaving(),e.createNotice("success",e.successNote+t,{isDismissible:!1})}}),[e.status]),(0,f.useEffect)((function(){var t=document.querySelector(".editor-post-title");t&&t.classList[e.isPublic?"remove":"add"]("rrze-newsletter-post-title-hidden")}),[e.isPublic]),(0,f.createPortal)(wp.element.createElement(Oe,null),t)}));function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,l=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw l}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}(0,l.registerPlugin)("rrze-newsletter-edit",{render:je});var Ie=(0,s.compose)([(0,c.withSelect)((function(e){return{layoutId:(0,e("core/editor").getEditedPostAttribute)("meta").rrze_newsletter_template_id}}))])((function(e){var t=e.layoutId,r=Ce((0,f.useState)(window&&window.rrze_newsletter_data&&"1"!==window.rrze_newsletter_data.is_service_provider_configured),2),n=r[0],o=r[1];return n||-1===t?wp.element.createElement(V,{shouldDisplaySettings:n,onSetupStatus:o}):wp.element.createElement(f.Fragment,null,wp.element.createElement(_.PluginDocumentSettingPanel,{name:"newsletters-settings-panel",title:(0,i.__)("Newsletter","rrze-newsletter")},wp.element.createElement(oe,null),wp.element.createElement(he,null)),wp.element.createElement(_.PluginDocumentSettingPanel,{name:"newsletters-styling-panel",title:(0,i.__)("Styling","rrze-newsletter")},wp.element.createElement(ve,null)),wp.element.createElement(_.PluginDocumentSettingPanel,{name:"newsletters-testing-panel",title:(0,i.__)("Testing","rrze-newsletter")},wp.element.createElement(se,null)),wp.element.createElement(_.PluginDocumentSettingPanel,{name:"newsletters-layout-panel",title:(0,i.__)("Layout","rrze-newsletter")},wp.element.createElement(X,null)),wp.element.createElement(_e,null))}));function Ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(r),!0).forEach((function(t){De(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function De(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}(0,l.registerPlugin)("rrze-newsletter-sidebar",{render:Ie,icon:null}),(0,o.addFilter)("editor.BlockListBlock","rrze-newsletter/unsupported-features-notices",p),n()((function(){(0,e.unregisterBlockStyle)("core/separator","dots"),(0,e.unregisterBlockStyle)("core/social-links","logos-only"),(0,e.unregisterBlockStyle)("core/social-links","pill-shape")})),(0,o.addFilter)("blocks.registerBlockType","rrze-newsletter/core-blocks",(function(e,t){return"core/paragraph"!==t&&"core/buttons"!==t&&"core/columns"!==t||(e.supports=Be(Be({},e.supports),{},{align:[]})),"core/group"===t&&(e.supports=Be(Be({},e.supports),{},{align:["full"]})),e})),(0,l.registerPlugin)("rrze-newsletter-plugin",{render:b,icon:null})}()}();
//# sourceMappingURL=editor.js.map